# خلاصه فنی پروژه موتور جستجوی اینستاگرام

## معرفی محصول

ما یک محصول **Social Listening** داریم که به صورت مداوم پست‌های اینستاگرام را کرال می‌کند. هدف ما پیاده‌سازی یک موتور جستجوی قوی و مقیاس‌پذیر است که بتواند این حجم عظیم داده را به سرعت و با دقت بالا جستجو کند.

**وضعیت فعلی داده:**
- حدود **200 میلیون پست** در حال حاضر
- پیش‌بینی رشد به **500 میلیون پست** تا سال آینده

---

## 2. تکنولوژی‌های کلیدی

- **Elasticsearch**: موتور جستجو اصلی
- **SQL Server**: ذخیره‌سازی اصلی داده (Source of Truth)
- **Kafka**: صف پیام‌رسانی برای Real-time Processing
- **Redis**: کش کردن نتایج جستجو

---

## 3. Pre-Processing و ذخیره‌سازی داده

### الف) Pre-Processing هنگام ایندکس (Indexing Time)

**سوال:** چگونه باید کپشن‌ها را قبل از ایندکس کردن Pre-process کنیم؟ (Normalization، Hashtag Extraction، Embedding Generation و...)

### ب) Pre-Processing هنگام جستجو (Query Time)

**سوال:** چگونه باید Query کاربر را قبل از جستجو Pre-process کنیم؟ (Normalization، Query Expansion، Embedding و...)

---

## 4. استراتژی Hybrid Search (BM25 + Vector)

ما می‌خواهیم ترکیبی از جستجوی کلمات کلیدی و معنایی داشته باشیم تا بهترین نتیجه را بگیریم.

**فرمول پیشنهادی:**
```text
Final Score = (0.30 * BM25) + (0.25 * Vector) + (0.20 * Engagement) + (0.15 * Recency) + (0.10 * Authority)
```
- **BM25 (30%)**: برای تطبیق دقیق کلمات (مثلاً وقتی کاربر هشتگ خاصی را سرچ می‌کند).
- **Vector (25%)**: برای درک معنایی (Semantic).
- **Engagement (20%)**: تاثیر لایک و کامنت در رتبه بندی.
- **Recency (15%)**: اهمیت تازگی محتوا.
- **Authority (10%)**: اعتبار اکانت منتشر کننده.

**سوال:** آیا این استراتژی درست است؟ کامل است؟ آیا وزن‌ها (Weights) مناسب هستند؟

> [!IMPORTANT]
> **سوال مهم در مورد مدل وکتور:**
> برای تبدیل متن به وکتور (Embedding)، بهترین گزینه برای اسکیل ما چیست؟
> 1. استفاده از مدل‌های **Open Source** روی Hugging Face (مثل `all-MiniLM-L12-v2`) که خودمان هاست کنیم؟
> 2. استفاده از APIهای آماده مثل **OpenAI text-embedding-3-large**؟
> (با توجه به هزینه و Latency و حجم ۵۰۰ میلیون داکیومنت)

---

## 5. اندازه‌گیری دقت جستجو (Search Quality Metrics)

**سوال:** چطور می‌توانیم دقت جستجو را اندازه بگیریم؟ راه‌حل چیست؟ (NDCG، Precision/Recall، CTR و...)
